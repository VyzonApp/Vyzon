<!DOCTYPE html>
<html>
    <head>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
        <script type="importmap">
            {
                "imports": {
                    "@material/web/": "https://esm.run/@material/web/"
                }
            }
        </script>
        <script type="module">
            import '@material/web/all.js';
            import {styles as typescaleStyles} from '@material/web/typography/md-typescale-styles.js';
            document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
        </script>
        <title>Vyzon</title>
        <link rel="stylesheet" id="styleelem" href="" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <meta name="apple-mobile-web-app-title" content="Vyzon">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="apple-touch-icon" href="/assets/images/nlogo.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/nfavicon-32x32.png?v=2">
        <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/nfavicon-16x16.png?v=2">
        <link rel="icon" type="image/x-icon" href="/assets/images/nfavicon.ico?v=2">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <style>
            .openinfo {
                position: fixed;
                top: 0;
                left: 0;
                z-index: 10000;
                background: white;
                width: 100%;
                height: 100%;
            }
            @keyframes oipulse {
                0% {
                    transform: scale(100%);
                }
                50% {
                    transform: scale(110%);
                }
                100% {
                    transform: scale(100%);
                }
            }
        </style>
        <meta name="HandheldFriendly" content="true" />
        <style id="accentstyle"> /* Accents */
            :root {
                --vyzon-accent: rgb(4,159,161);
                --vyzon-accent-75: rgb(4,159,161,0.75);
                --vyzon-accent-50: rgb(4,159,161,0.75);
                --vyzon-accent-25: rgb(4,159,161,0.25);
                --vyzon-accent-15: rgb(4,159,161,0.15);
                --vyzon-accent-05: rgb(4,159,161,0.05);
            }
        </style>
        <style> /* Base Definition */
            :root {
                --md-sys-color-primary: var(--vyzon-accent);
                --md-sys-color-on-primary: var(--vyzon-text-on-accent);
                --md-sys-color-on-primary-container: var(--vyzon-text-hard);
                --md-sys-color-secondary-container: var(--vyzon-accent-25);
                --md-sys-color-on-secondary-container: var(--vyzon-text-hard);
                --md-sys-color-surface-container-high: var(--vyzon-bg-alt);
                --md-sys-color-surface-container-highest: var(--vyzon-accent-15);
                --md-sys-color-surface-container: var(--vyzon-bg-alt);
                --md-sys-color-surface: var(--vyzon-bg-alt);
                --md-sys-color-on-surface: var(--vyzon-text-hard);
                --md-sys-color-on-surface-variant: var(--vyzon-text);
                --md-sys-color-outline: var(--vyzon-text-hard);
                --md-sys-color-outline-variant: var(--vyzon-text-hard);
                --md-sys-color-tertiary-container: var(--vyzon-text-hard);
                --md-filled-button-label-text-color: var(--vyzon-text-on-accent);
                --md-dialog-container-color: var(--vyzon-bg-alt2);
                --md-primary-tab-container-color: var(--vyzon-bg-alt2);
            }
            md-filled-icon-button md-icon {
                color: var(--vyzon-text-on-accent);
            }
        </style>
        <style id="dmodestyle"> /* Dark Mode */
            :root {
                --vyzon-full-bg: rgba(30,30,30);
                --vyzon-bg: transparent;
                --vyzon-bg-alt: rgba(50,50,50);
                --vyzon-bg-alt2: rgb(25,25,25);
                --vyzon-outline: rgb(150,150,150);
                --vyzon-outline-hard: white;
                --vyzon-text: rgb(200,200,200);
                --vyzon-text-hard: white;
                --vyzon-text-soft: rgb(75,75,75);
                --vyzon-text-soft-alt: rgb(150,150,150);
                --vyzon-text-soft-alt-2: rgb(200,200,200);
                --vyzon-text-on-accent: rgb(255,255,255);
            }
            .taskswrapper::after {
                content: "";
                position: absolute;
                border-radius: 5000px;
                top: 175px;
                left: 50%;
            }
            .contentHolder::after {
                content: "";
                position: absolute;
                left: 50%;
                right: 50%;
                top: 25%;
            }
            .topmenu {
                border-bottom: 1px solid transparent;
            }
            .topmenu:after {
                content: "";
                bottom: -1px;
                left: 0;
                width: 100%;
                height: 1px;
                position: absolute;
                background: linear-gradient(90deg, var(--vyzon-accent-05), var(--vyzon-accent-75), var(--vyzon-accent-05))
            }
            .feedbtn md-icon {
                color: rgb(200, 130, 255);
            }
            @media (max-width: 700px) {
                :root {
                    --vyzon-full-bg: rgba(10,10,10);
                }
                .topmenu {
                    border-bottom: 1px solid transparent;
                }
                .topmenu::after {
                    background: transparent;
                }
            }
        </style>
        <style id="lmodestyle"> /* Light Mode */
            :root {
                --vyzon-full-bg: rgba(245,245,245);
                --vyzon-bg: rgb(255,255,255);
                --vyzon-bg-alt: rgb(255,255,255);
                --vyzon-bg-alt2: rgb(255,255,255);
                --vyzon-outline: rgb(200,200,200);
                --vyzon-outline-hard: black;
                --vyzon-text: rgb(75,75,75);
                --vyzon-text-hard: black;
                --vyzon-text-soft: rgb(75,75,75);
                --vyzon-text-soft-alt: rgb(100,100,100);
                --vyzon-text-soft-alt-2: rgb(150,150,150);
                --vyzon-text-on-accent: rgb(255,255,255);
            }
            .feedbtn {
                --md-fab-container-color: rgb(240,200,255);
            }
        </style>
        <style id="profileStyle"></style>
    </head>
    <body>
        <div class="openinfo"></div>
        <div class="topmenu">
            <span style="position: relative">
                <md-icon-button class="menubtn" id="menu-anchor">
                    <md-icon>menu</md-icon>
                    <span id="friendRequests">1</span>
                </md-icon-button>
                <md-menu id="menu-menu" anchor="menu-anchor">
                    <md-menu-item>
                        <div slot="headline" onclick="document.getElementById('newVersion').show()">News</div>
                    </md-menu-item>
                    <md-menu-item>
                        <div slot="headline" onclick="friendListOpen()">Social</div>
                    </md-menu-item>
                    <md-menu-item>
                        <div slot="headline" onclick="document.getElementById('settings').show()">Settings</div>
                    </md-menu-item>
                </md-menu>
            </span>
            <h1 class="menutitle">
                Vyzon
                <span class="probox">
                    <span class="pro">PRO</span>
                </span>
                <span class="beta">TR</span>
                <span class="modeselect" style="position: relative" id="modeswitchanchor">
                    <span id="modeindicator">Tasks</span>
                    <md-menu id="modesmenu" anchor="modeswitchanchor">
                        <md-menu-item value="Tasks">
                            <div slot="headline" onclick="switchModes(0)">Tasks</div>
                        </md-menu-item>
                        <md-menu-item value="Calendar" onclick="switchModes(1)">
                            <div slot="headline">Calendar</div>
                        </md-menu-item>
                        <md-menu-item value="Whiteboard" onclick="switchModes(2)">
                            <div slot="headline">Whiteboard</div>
                        </md-menu-item>
                    </md-menu>
                    <button>
                        <md-icon>arrow_drop_down</md-icon>
                    </button>
                </span>
                
            </h1>
            <span style="position: relative">
                <md-icon-button id="acc-anchor" onclick="loadUserProfile()">
                    <md-icon>account_circle</md-icon>
                </md-icon-button>
            </span>
        </div>
        <div class="contentHolder" id="chTasks">
            <div class="content" id="content">
                <div class="taskswrapper">
                    <div class="tasks">
                        <md-filled-select class="listselect" onchange="listSwitch()" id="listselect">
                            <md-select-option selected value="0">
                                <div slot="headline">Main List</div>
                            </md-select-option>
                            <md-select-option value="new" id="newlist">
                                <div slot="headline"><i>Add new list...</i></div>
                            </md-select-option>
                            <md-select-option value="del" id="dellist">
                                <div slot="headline"><i>Delete list...</i></div>
                            </md-select-option>
                        </md-filled-select>
                        <button class="topbtn" onclick="reload2()">
                            <md-icon>refresh</md-icon>
                            <md-ripple></md-ripple>
                        </button>
                        <span class="notasks">You don't have any tasks on this list.</span>
                        <div id="taskholder"></div>
                        <md-circular-progress indeterminate class="loader" style="margin-top: 10px"></md-circular-progress>
                    </div>
                    <md-fab id="feedbtn" class="feedbtn" onclick="document.getElementById('sendFeedback').show()">
                        <md-icon slot="icon">feedback</md-icon>
                    </md-fab>
                    <md-fab class="addbtn" onclick="document.getElementById('addTask').show()">
                        <md-icon slot="icon">add</md-icon>
                    </md-fab>
                </div>
            </div>
            <div class="competition" id="competition">
                <md-ripple class="cripple"></md-ripple>
                <div class="stats" id="cstats" onclick="readyCompetition()">
                    <div class="indicator">
                        <div class="names">
                            <span>You</span>
                            <span id="user2name"></span>
                        </div>
                        <div class="progress">
                            <md-linear-progress id="bar1"></md-linear-progress>
                            <md-linear-progress id="bar2"></md-linear-progress>
                        </div>
                    </div>
                    <div class="cwl" id="win">You won!</div>
                    <div class="cwl" id="lose">You lost. :(</div>
                </div>
                <div class="winreveal" id="creveal" onclick="dismissCompetition()">
                    <span class="winname"><span id="winneruser"></span> won! <span class="cdismiss">Click</span><span class="tdismiss">Tap</span> to dismiss.</span>
                    <md-ripple></md-ripple>
                </div>
            </div>
        </div>
        <div class="contentHolder" id="chCalendar">
            <div class="content">
                <div class="monthname">
                    <span><span id="mnmonth"></span> <span id="mnyear"></span></span>
                    <div class="forwardbackbuttons">
                        <md-outlined-icon-button id="msbackwardbtn" onclick="switchMonth()">
                            <md-icon>chevron_backward</md-icon>
                        </md-outlined-icon-button>
                        <md-outlined-icon-button id="msforwardbtn" onclick="switchMonth()">
                            <md-icon>chevron_forward</md-icon>
                        </md-outlined-icon-button>
                    </div>
                </div>
                <div class="weeknames wlarge">
                    <div class="weekname">Sunday</div>
                    <div class="weekname">Monday</div>
                    <div class="weekname">Tuesday</div>
                    <div class="weekname">Wednesday</div>
                    <div class="weekname">Thursday</div>
                    <div class="weekname">Friday</div>
                    <div class="weekname">Saturday</div>
                </div>
                <div class="weeknames wsmall">
                    <div class="weekname">sun</div>
                    <div class="weekname">mon</div>
                    <div class="weekname">tue</div>
                    <div class="weekname">wed</div>
                    <div class="weekname">thu</div>
                    <div class="weekname">fri</div>
                    <div class="weekname">sat</div>
                </div>
                <div id="calendargrid"></div>
            </div>
        </div>
        <div class="contentHolder" id="chWhiteboard">
            <div class="content">
                <span class="notaskswhiteboard" id="whiteboardlistsempty">You have no tasks.</span>
                <div id="whiteboardcontent"></div>
            </div>
        </div>
        <md-dialog id="addTask">
            <div slot="headline">Create a task</div>
            <form slot="content" id="addTaskForm" onsubmit="event.preventDefault(); addNewTask(); return false">
                <div class="group desc">
                    <span class="ntaskicon"><md-icon>article</md-icon></span>
                    <md-outlined-text-field
                        id="tasknamefield"
                        class="field"
                        label="Name"
                        required
                        error-text="Please add a task name">
                    </md-outlined-text-field>
                </div>
                <div class="group desc">
                    <span class="ntaskicon"><md-icon>calendar_month</md-icon></span>
                    <md-outlined-text-field
                        id="taskdatefield"
                        type="date"
                        class="field"
                        label="Date">
                    </md-outlined-text-field>
                </div>
                <div class="group">
                    <span class="ntaskicon descicon"><md-icon>description</md-icon></span>
                    <md-outlined-text-field
                        id="taskdescfield"
                        type="textarea"
                        class="field desc"
                        label="Description"
                        style="margin-bottom: 10px">
                    </md-outlined-text-field>
                </div>
                <div class="group">
                    <span class="ntaskicon descicon"><md-icon>repeat</md-icon></span>
                    <md-outlined-select
                        id="taskrepeatfield"
                        class="field"
                        style="margin-bottom: 10px; width: 100%">
                        <md-select-option selected value="0">Do Not Repeat</md-select-option>
                        <md-select-option value="1">Repeat Daily</md-select-option>
                        <md-select-option value="7">Repeat Weekly</md-select-option>
                        <md-select-option value="30">Repeat Monthly</md-select-option>
                        <md-select-option value="365">Repeat Yearly</md-select-option>
                    </md-outlined-select>
                </div>
                <label style="display: flex; gap: 6px; align-items: center; font-size: 16px">
                    <md-checkbox id="taskpriorityfield"></md-checkbox>
                    Priority
                </label>
            </form>
            <div slot="actions">
                <md-filled-button form="addTaskForm">Create</md-filled-button>
            </div>
        </md-dialog>
        <md-dialog id="editTask">
            <div slot="headline">Edit task</div>
            <form slot="content" id="editTaskForm" onsubmit="event.preventDefault(); finalizeTaskEdit(document.getElementById('etempid')); return false">
                <span id="etempid"></span>
                <div class="group desc">
                    <span class="ntaskicon"><md-icon>article</md-icon></span>
                    <md-outlined-text-field
                        id="etasknamefield"
                        class="field"
                        label="Name"
                        required
                        error-text="Please add a task name">
                    </md-outlined-text-field>
                </div>
                <div class="group desc">
                    <span class="ntaskicon"><md-icon>calendar_month</md-icon></span>
                    <md-outlined-text-field
                        id="etaskdatefield"
                        type="date"
                        class="field"
                        label="Date">
                    </md-outlined-text-field>
                </div>
                <div class="group">
                    <span class="ntaskicon descicon"><md-icon>description</md-icon></span>
                    <md-outlined-text-field
                        id="etaskdescfield"
                        type="textarea"
                        class="field desc"
                        label="Description"
                        style="margin-bottom: 10px">
                    </md-outlined-text-field>
                </div>
                <div class="group">
                    <span class="ntaskicon descicon"><md-icon>repeat</md-icon></span>
                    <md-outlined-select
                        id="etaskrepeatfield"
                        class="field"
                        style="margin-bottom: 10px; width: 100%">
                        <md-select-option selected value="0">Do Not Repeat</md-select-option>
                        <md-select-option value="1">Repeat Daily</md-select-option>
                        <md-select-option value="7">Repeat Weekly</md-select-option>
                        <md-select-option value="30">Repeat Monthly</md-select-option>
                        <md-select-option value="365">Repeat Yearly</md-select-option>
                    </md-outlined-select>
                </div>
                <label style="display: flex; gap: 6px; align-items: center; font-size: 16px">
                    <md-checkbox id="etaskpriorityfield"></md-checkbox>
                    Priority
                </label>
            </form>
            <div slot="actions">
                <md-text-button class="delpasswordbtn" onclick="document.getElementById('editTask').close(); deleteTask(document.getElementById('etempid').textContent)">Delete</md-text-button>
                <md-filled-button form="editTaskForm">Save</md-filled-button>
            </div>
        </md-dialog>
        <md-dialog id="addList">
            <div slot="headline">Create a list</div>
            <form slot="content" id="addListForm" onsubmit="event.preventDefault(); addNewList(); return false">
                <md-outlined-text-field
                    id="listnamefield"
                    class="field"
                    label="List Name"
                    required
                    error-text="Please add a list name"
                    style="margin-bottom:5px;">
                </md-outlined-text-field>
                <label>Share with friend...</label>
                <md-outlined-select
                    class="field"
                    id="listuserfield"
                    style="width: 100%;">
                </md-outlined-select>
            </form>
            <div slot="actions">
                <md-filled-button form="addListForm">Create</md-filled-button>
            </div>
        </md-dialog>
        <md-dialog id="delList">
            <div slot="headline">Delete a list</div>
            <form slot="content" id="delListForm" onsubmit="event.preventDefault(); deleteList(); return false">
                <md-outlined-select id="dellistselectfield" required error-text="Please specify a list" style="width:100%">
                    <md-select-option selected disabled>
                        <div slot="headline">Select an option...</div>
                    </md-select-option>
                </md-outlined-select>
            </form>
            <div slot="actions">
                <md-filled-button form="delListForm">Delete</md-filled-button>
            </div>
        </md-dialog>
        <md-dialog id="accountInfo">
            <div slot="headline">
                <md-icon-button onclick="editProfile()" class="reloadbtn"><md-icon>edit</md-icon></md-icon-button>
                <span id="usernameacc"></span>
            </div>
            <form slot="content" id="accountModal" onsubmit="event.preventDefault(); document.getElementById('accountInfo').close(); return false">
            </form>
            <div slot="actions">
                <md-text-button onclick="logOut()">Log Out</md-text-button>
                <md-filled-button form="accountModal">Close</md-filled-button>
            </div>
        </md-dialog>
        <md-dialog id="profile">
            <div slot="headline">
                <span id="pfusername"></span>
                <md-filled-icon-button id="profilebtn" onclick="profileBtn()" class="profilebtn"><md-icon></md-icon></md-filled-icon-button>
            </div>
            <form slot="content" id="profileForm" onsubmit="event.preventDefault(); document.getElementById('profile').close()">
                <span id="pfabtme"></span>
                <div class="accountoptions" id="accountoptions">
                    <div class="colorOption">
                        <input type="color" class="editColor" id="colorInputPrimary" />
                        <label for="colorInputPrimary">Primary</label>
                    </div>
                    <div class="colorOption">
                        <input type="color" class="editColor" id="colorInputSecondary" />
                        <label for="colorInputSecondary">Secondary</label>
                    </div>
                    <div class="colorOption">
                        <input type="text" class="editFont" id="fontInput" />
                        <label for="fontInput">Font</label>
                    </div>
                </div>
            </form>
            <div slot="actions">
                <md-text-button onclick="resetColors()" id="resetColorBtn">Reset</md-text-button>
                <md-text-button form="profileForm">Close</md-text-button>
            </div>
        </md-dialog>
        <md-dialog id="friendList">
            <div slot="headline">Social</div>
            <div slot="content">
                <form class="group" onsubmit="event.preventDefault(); addFriend(); return false">
                    <md-outlined-text-field
                        id="addfriendfield"
                        type="text"
                        class="field"
                        label="Add a friend by username..."
                        required
                        oninput="event.target.value = event.target.value.toLowerCase()"
                        autocomplete="off">
                    </md-outlined-text-field>
                    <md-filled-button class="friendadd" id="friendaddbtn"><md-icon>add</md-icon></md-filled-button>
                </form>
                <span class="ferror" id="ferror"></span>
                <div class="requests">
                    <span class="sectionhead">Pending Requests</span>
                    <span class="roaster" id="roast1"></span>
                    <div class="floaddiv">
                    </div>
                    <div id="finc"></div>
                    <div id="fout"></div>
                </div>
                <div class="friends">
                    <span class="sectionhead">Your Friends</span>
                    <span class="roaster" id="roast2"></span>
                    <div class="floaddiv">
                    </div>
                    <div id="friendRows"></div>
                </div>
            </div>
        </md-dialog>
        <md-dialog id="settings">
            <div slot="headline">
                <span style="flex: 1;">Settings</span>
                <md-icon-button onclick="event.preventDefault();event.target.parentElement.parentElement.close()">
                    <md-icon>close</md-icon>
                </md-icon-button>
            </div>
            <div id="settingsContent" slot="content">
                <md-tabs id="settingsOptions">
                    <md-primary-tab>
                        <md-icon slot="icon">settings</md-icon>
                        General
                    </md-primary-tab>
                    <md-primary-tab>
                        <md-icon slot="icon">palette</md-icon>
                        Appearance
                    </md-primary-tab>
                </md-tabs>
                <div id="settingsGroup0" class="settingsGroup" style="display: initial">
                    <label class="switch">
                        <span class="switchlabel">Allow Friend Requests</span>
                        <md-switch id="setting1" selected onchange="setSetting(1, event.target.selected)"></md-switch>
                    </label>
                    <label class="switch">
                        <span class="switchlabel">Enable Feedback</span>
                        <md-switch id="setting2" selected onchange="setSetting(2, event.target.selected)"></md-switch>
                    </label>
                </div>
                <div id="settingsGroup1" class="settingsGroup">
                    <label class="switch">
                        <span class="switchlabel">Dark Mode</span>
                        <md-switch id="setting0" onchange="setSetting(0, event.target.selected)"></md-switch>
                    </label>
                    <div id="colorHolder">
                        <button class="colorIcon"
                        onclick="switchColor('4,159,161')"
                        style="background: rgb(4,159,161)"></button>
                        <button class="colorIcon"
                        onclick="switchColor('255,0,0')"
                        style="background: rgb(255,0,0)"></button>
                        <button class="colorIcon"
                        onclick="switchColor('0,0,255')"
                        style="background: rgb(0,0,255)"></button>
                        <button class="colorIcon"
                        onclick="switchColor('0,255,255')"
                        style="background: rgb(0,255,255)"></button>
                        <button class="colorIcon"
                        onclick="switchColor('255,150,255')"
                        style="background: rgb(255,150,255)"></button>
                        <button class="colorIcon"
                        onclick="switchColor('150,200,150')"
                        style="background: rgb(150,200,150)"></button>
                        <button class="colorIcon"
                        onclick="switchColor('255,100,50')"
                        style="background: rgb(255,100,50)"></button>
                        <button class="colorIcon"
                        onclick="switchColor('168,112,53')"
                        style="background: rgb(168,112,53)"></button>
                        <button class="colorIcon"
                        onclick="switchColor('150,0,150')"
                        style="background: rgb(150,0,150)"></button>
                        <button class="colorIcon"
                        onclick="switchColor('255,0,255')"
                        style="background: rgb(255,0,255)"></button>
                        <button class="colorIcon"
                        onclick="switchColor('150,150,150')"
                        style="background: rgb(150,150,150)"></button>
                    </div>
                    Even more beautiful colors are coming soon, stay tuned!
                </div>
            </div>
            <div slot="actions">
                <md-filled-button onclick="logOut();">Log Out</md-filled-button>
            </div>
        </md-dialog>
        <md-dialog id="startCompetition">
            <div slot="headline">Start Competition</div>
            <form slot="content" id="startCompetitionForm" onsubmit="event.preventDefault(); startCompetition(); return false">
                <label>Friend to Compete Against</label>
                <div class="cfields" style="display: flex; gap: 10px; margin-bottom: 10px">
                    <md-outlined-select
                        id="ctaskAgainst"
                        style="width: 100%;"
                        required>
                    </md-outlined-select>
                </div>
                <label>Amount of Tasks</label>
                <md-slider
                    labeled
                    min="3"
                    max="50"
                    value="25"
                    id="tasksAmount"
                    style="width: 100%">
                </md-slider>
                <span class="ferror" id="cferror"></span>
            </form>
            <div slot="actions">
                <md-filled-button form="startCompetitionForm">Start</md-filled-button>
            </div>
        </md-dialog>
        <md-dialog id="competitionStats">
            <div slot="headline">Competition Stats</div>
            <div slot="content">
                <label id="cname1"></label>
                <md-linear-progress id="sbar1" value="0.5" class="compstatbar"></md-linear-progress>
                <label class="numstat" id="nstat1">5/10</label>
                <label id="cname2"></label>
                <md-linear-progress id="sbar2" value="0.75" class="compstatbar"></md-linear-progress>
                <label class="numstat" id="nstat2">7.5/10</label>
            </div>
            <div slot="actions">
                <md-text-button onclick="openAbandonCompetition()" id="abandonBtn">Abandon</md-text-button>
                <md-filled-button onclick="document.getElementById('competitionStats').close();">Close</md-filled-button>
            </div>
        </md-dialog>
        <md-dialog id="abandonCompetition">
            <div slot="headline">Abandon Competition</div>
            <form slot="content" id="abandonCompetitionForm" onsubmit="event.preventDefault(); abandonCompetition(); return false">
                <div class="desc">You can still win this competition!</div>
                <div style="color: red">Are you you want to quit?</div>
            </form>
            <div slot="actions">
                <md-filled-button onclick="event.preventDefault(); document.getElementById('abandonCompetition').close();">Cancel</md-filled-button>
                <md-text-button form="abandonCompetitionForm" class="delpasswordbtn" id="abandonBtn">Abandon</md-filled-button>
            </div>
        </md-dialog>
        <md-dialog id="sendFeedback">
            <div slot="headline">Feedback Center</div>
            <form slot="content" id="sendFeedbackForm" onsubmit="event.preventDefault(); sendFeedback(); return false">
                What type of feedback do you intend to submit?
                <md-outlined-select required id="fType" onchange="feedbackEmail()">
                    <md-select-option value="suggestion">Suggestion</md-select-option>
                    <md-select-option value="bug">Bug Report</md-select-option>
                    <md-select-option value="support">Support Request</md-select-option>
                    <md-select-option value="other">Other</md-select-option>
                </md-outlined-select>
                <md-outlined-text-field id="fEmail"
                    placeholder="Email (Optional)"
                    class="desc"
                    type="email">
                </md-outlined-text-field>
                <md-outlined-text-field id="fTitle"
                    placeholder="Title"
                    class="desc"
                    required>
                </md-outlined-text-field>
                <md-outlined-text-field id="fText"
                    placeholder="Tell us your feedback..."
                    class="desc"
                    type="textarea"
                    rows="4"
                    required>
                </md-outlined-text-field>
            </form>
            <div slot="actions">
                <md-filled-button form="sendFeedbackForm">Send</md-filled-button>
            </div>
        </md-dialog>
        <md-dialog id="calendartasks">
            <div slot="headline">
                <span style="flex: 1;" id="calendarmodaldate"></span>
                <md-icon-button onclick="event.preventDefault();event.target.parentElement.parentElement.close()">
                    <md-icon>close</md-icon>
                </md-icon-button>
            </div>
            <div slot="content">
                <span id="nodatetasks">There are no tasks for this date.</span>
                <div id="calendartasksholder"></div>
            </div>
        </md-dialog>
        <md-dialog id="sendFeedbackConfirm">
            <div slot="headline">Thank you for your feedback!</div>
            <div slot="content">
                <div>We really, really appreciate your contribution to Vyzon. The team will look through this and try to resolve your issue. If you provided an email, we may follow up asking for more info.</div>
            </div>
            <div slot="actions">
                <md-filled-button onclick="document.getElementById('sendFeedbackConfirm').close()">Close</md-filled-button>
            </div>
        </md-dialog>

        <md-dialog id="loginNotice" onclose="event.preventDefault()">
            <div slot="headline">You're not logged in.</div>
            <div slot="content">
                <div>To access Vyzon, you need to either log in or create an account.</div>
            </div>
            <div slot="actions">
                <a class="notlink" href="https://milnm.com/auth.html?url=dnl6b24uYXBw"><md-filled-button>Continue</md-filled-button></a>
            </div>
        </md-dialog>

        <md-dialog id="newVersion" onclose="localStorage.setItem('modalVersion', Version.slice(0, 7))">
            <div slot="headline">Express yourself with Vyzon</div>
            <div slot="content" id="nVContent">
                <img src="/assets/images/image2.png" width="100%" draggable="false" style="border-radius:20px;margin-top: 5px" />
                <p>Vyzon is always built with security in mind from the ground up. Here's some updates we've been working on to continue our mission to create the best to-do list.</p>
                <br>
                <p><b>Profiles:</b> You can add custom colors, a custom font, and a bio to your profile that displays itself when users click your name on the friends list. To customize, go to the new account menu.</p>
                <p><b>Milenium Accounts:</b> Milenium accounts are here! They're a better and more secure way to access Vyzon. Plus, you'll be able to use the same account for future Milenium services, and your profile and friends will be synced across every one of them.</p>
                <p><b>New Legal Documents:</b> By using Vyzon and all other Milenium services, you now will have to follow the policies of all our legal documents. To view them, you can go to <a href="https://milnm.com/info">https://milnm.com/info</a> at any time.</p>
                <p><b>Tokens:</b> Logging into your account is now more secure! Your login details are hidden and each logged in device has its own individual "secret" password called a token. This prevents hackers from stealing your password!</p>
                <br>
                <p>We're so excited to see what users do with these updates and how your account is kept far more secure. Have fun customizing your profile! We're excited to see what you create.</p>
                <br>
                <p>- The Vyzon Team</p>
                <br>
                <p><small>Psst - if you encounter any bugs or have any suggestions for the next update, feel free to use the feedback button in the bottom left of your task list. It really helps!</small></p>
            </div>
            <div slot="actions">
                <md-filled-button onclick="document.getElementById('newVersion').close();">OK</md-filled-button>
            </div>
        </md-dialog>
    </body>

    <script>
        Version = "24.09.2.0";
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.getElementById("lmodestyle").media = "max-width: 1px";
            document.getElementById("dmodestyle").media = "";
            document.querySelector(".openinfo").style.background = "black";
        }
        if (Version.includes("T")) {
            document.querySelector(".beta").style.display = "flex";
        } else {
            document.querySelector(".beta").style.display = "none";
        }
        document.getElementById("styleelem").href = "/assets/script/styles.css?v=" + Version;
        window.onload = function () {
            const params = new URL(location).searchParams;
            if (params.get("code") == undefined) {
                if (localStorage.getItem("token") == null) {
                    if (localStorage.getItem("password") == null) {
                        document.getElementById("loginNotice").show();
                    } else {
                        location = "https://milnm.com/auth.html?url=dnl6b24uYXBw&migrate=" + btoa(JSON.stringify({"Username":localStorage.getItem("username"),"Password":localStorage.getItem("password")}))
                    }
                } else {
                    if (localStorage.getItem('modalVersion') != Version.slice(0, 7)) {
                        document.getElementById('newVersion').show();
                    }
                    var statusReturn = apiRequest("+https://api.milnm.com/account/validatetoken", "POST", true, localStorage.getItem("token"));
                    statusReturn.then(function (name) {
                        localStorage.setItem("username", name);
                        document.getElementById("usernameacc").textContent = localStorage.getItem("username");
                        var scpt = document.createElement("script");
                        scpt.src = "/assets/script/script.js?v=" + Version;
                        document.body.appendChild(scpt);
                    })
                }
            } else {
                localStorage.setItem("token", params.get("code"));
                location = "/"
            }
        }
        // API
        function apiRequest(endpoint, type, async, send, withstatus) {
            return new Promise((resolve, reject) => {
                const xhr = new XMLHttpRequest();
                if (endpoint.charAt(0) == "+") {
                    xhr.open(type, endpoint.substring(1), async);
                } else {
                    xhr.open(type, "https://api.vyzon.app/" + endpoint, async);
                }
                xhr.setRequestHeader("token", localStorage.getItem("token"));
                xhr.onload = function () {
                    if (withstatus) {
                        try {
                            resolve({
                                "data": JSON.parse(xhr.response),
                                "status": xhr.status
                            });
                        } catch {
                            resolve({
                                "data": xhr.response,
                                "status": xhr.status
                            });
                        }
                    } else {
                        try {
                            resolve(JSON.parse(xhr.response))
                        } catch {
                            resolve(xhr.response);
                        }
                    }
                }
                xhr.onerror = function () {
                    reject(new Error(`Client error.`));
                }
                xhr.send(send);
            })
        }

        function logOut() {
            localStorage.clear();
            location.reload();
        }
    </script>
</html>